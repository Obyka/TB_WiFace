{% extends "base.html" %}

{% block title %}Detailled identity{% endblock %}

{% block header %}Detailled profile{% endblock %}

{% block content %}
<div class="w3-card w3-round w3-white w3-third" style="margin-right: 10px;">
  <div class="w3-container">
  <div id="googleMap" style="width:100%;height:400px;"></div>
  </div>
</div>


<div class="w3-card w3-round w3-white w3-rest">
  <div class="w3-container">
   <h4 class="w3-center">{{identity.uuid}}</h4>
   <p class="w3-center" style="display:none" id="picture"><a href="{{url_for('web_bp.pictures_front', id=best_pic.id)}}"><img src="{{ url_for('web_bp.static', filename='images/'+best_pic.picPath) }}" class="w3-circle" style="height:106px;width:106px" alt="Avatar"></a></p>
   <p class="w3-center" id="avatar"><a href="{{url_for('web_bp.pictures_front', id=best_pic.id)}}"><img src="{{ url_for('web_bp.static', filename='images/'+avatar_path) }}" class="w3-circle" style="height:106px;width:106px" alt="Avatar"></a></p>
  
    <p class="w3-center"><button id="buttonPicture" class="w3-red w3-btn w3-round-xxlarge" onclick="switchPhoto()">Show picture</button></p>

   <hr>
   {% if gender and gender < 0 %}
   <p class="w3-center w3-xlarge"><i class="fa fa-mars fa-fw"></i> Male</p>
   {% elif gender%}
   <p class="w3-center w3-xlarge"><i class="fa fa-venus fa-fw"></i> Female</p>
   {% endif %}

   {% if age_range %}
   <p class="w3-center w3-xlarge"><i class="fa fa-birthday-cake fa-fw"></i> Estimated Age: {{age_range[0]}} - {{age_range[1]}}</p>
   {% endif %}

   {% if identity.firstname or identity.lastname%}
   <p class="w3-center w3-xlarge">
     <i class="fa fa-id-card-o fa-fw"></i> {{identity.firstname}} {{identity.lastname}}
  </p>
  {% endif %}

  {% if nb_picture %}
  <p class="w3-center w3-xlarge">
    <i class="fa fa-picture-o fa-fw"></i> <a href="{{url_for('web_bp.represents_front', id=identity.id)}}" >Number of taken pictures: {{nb_picture}}</a>
  </p>
  {% endif %}

  {% if identity.mail %}
   <p class="w3-center w3-xlarge"><i class="fa fa-envelope fa-fw"></i> {{identity.mail}}</p>
   {% endif %}
   {% if best_macs%}
   <p class="w3-center w3-xlarge"><i class="fa fa-mobile  fa-fw"></i> MAC: 
    {% for mac in best_macs %}
    <a href="{{ url_for('web_bp.macs_front', id=mac.fk_mac) }}">{{mac.fk_mac}}</a>
    {% endfor %}
    {% endif %}
  </div>
</div>
{% endblock %} 

 {% block script%}
 <script type="text/javascript" src="{{url_for('web_bp.static', filename='js/switchPicture.js')}}"></script>
 <script>
  function myMap() {
    var mapProp= {
      center: {lat: -34.397, lng: 150.644},
      zoom:5
 };

 arrayMarker = []
 {% for picture_place in pictures_place%}
  var contentString = '{{picture_place.name}}<br>' + 'Latitude: ' + '{{picture_place.latitude}}<br>' + 'Longitude: ' +'{{picture_place.longitude}}<br>';
  var marker = new google.maps.Marker({
    icon: "https://maps.google.com/mapfiles/ms/icons/blue-dot.png",
    position: new google.maps.LatLng({{picture_place.latitude}}, {{picture_place.longitude}}),
    map: map,
    title: "{{picture_place.name}}"
});

google.maps.event.addListener(marker, 'click', function(content) {
  infowindow = new google.maps.InfoWindow();
  return function(){
      infowindow.setContent(content);
      infowindow.open(map,this);
  }
  }(contentString));

arrayMarker.push(marker)
 {% endfor %}
 {% for mac_data in mac_datas %}
 {% for place in mac_data.places %}
 var contentString = '{{place.name}}<br>' + 'Latitude: ' + '{{place.latitude}}<br>' + 'Longitude: ' +'{{place.longitude}}<br>';
 var marker = new google.maps.Marker({
  icon: "https://maps.google.com/mapfiles/ms/icons/green-dot.png",
  position: new google.maps.LatLng({{place.latitude}}, {{place.longitude}}),
  map: map,
  title: "{{place.name}}"
});

google.maps.event.addListener(marker, 'click', function(content) {
  infowindow = new google.maps.InfoWindow();
  return function(){
      infowindow.setContent(content);
      infowindow.open(map,this);
  }
  }(contentString));

arrayMarker.push(marker)
{% endfor %}
{% endfor %}

mapProp.center = new google.maps.LatLng({{pictures_place[0].latitude}}, {{pictures_place[0].longitude}});

 var map = new google.maps.Map(document.getElementById("googleMap"),mapProp);
 arrayMarker.forEach(function(element){
  element.setMap(map);
 });
}
  </script>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCNgwbDiCLi_-4w3R0vPxRVhtUuqvALti0&callback=myMap"></script>
{{ super() }}

{% endblock %}


